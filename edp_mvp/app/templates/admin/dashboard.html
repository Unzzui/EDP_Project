{% extends "base_unified.html" %} {% block title %}Panel de Administración -
Pagora{% endblock %} {% block extra_head %}
<style>
  /* Animaciones mejoradas */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes slideUp {
    from {
      transform: translateY(30px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes slideInRight {
    from {
      transform: translateX(30px);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes bounceGentle {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-8px);
    }
  }

  @keyframes pulse {
    0%,
    100% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.8;
    }
  }

  @keyframes glow {
    0%,
    100% {
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
    }
    50% {
      box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
    }
  }

  /* Gradiente más sutil y harmonioso para header */
  .admin-gradient {
    background: linear-gradient(
      135deg,
      #667eea 0%,
      #764ba2 35%,
      #667eea 70%,
      #5a67d8 100%
    );
    background-size: 300% 300%;
    animation: gradientShift 8s ease infinite;
    position: relative;
    overflow: hidden;
    /* Asegurar que no hay desbordamiento horizontal */
    width: 100%;
  }

  .admin-gradient::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      45deg,
      rgba(255, 255, 255, 0.08) 0%,
      transparent 30%,
      rgba(255, 255, 255, 0.04) 50%,
      transparent 70%,
      rgba(255, 255, 255, 0.08) 100%
    );
    animation: shimmer 4s ease-in-out infinite;
  }

  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  @keyframes gradientShift {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  /* Cards con mejor cohesión visual */
  .admin-card {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 1rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    color: var(--text-primary);
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .admin-card::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(102, 126, 234, 0.1),
      transparent
    );
    transition: left 0.6s ease;
  }

  .admin-card:hover::before {
    left: 100%;
  }

  .admin-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
    border-color: rgba(102, 126, 234, 0.3);
    background: linear-gradient(145deg, var(--bg-card), var(--bg-subtle));
  }

  /* Íconos con colores más sutiles */
  .icon-container {
    position: relative;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 0.75rem;
    overflow: hidden;
  }

  .icon-container::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: currentColor;
    border-radius: 50%;
    opacity: 0.1;
    transition: all 0.3s ease;
    transform: translate(-50%, -50%);
  }

  .admin-card:hover .icon-container {
    transform: scale(1.05);
  }

  .admin-card:hover .icon-container::after {
    width: 110%;
    height: 110%;
  }

  /* Números estadísticos más elegantes */
  .stat-number {
    background: linear-gradient(45deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
    position: relative;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
  }

  /* Títulos más elegantes y sutiles */
  .section-title {
    color: var(--text-primary);
    position: relative;
    font-weight: 700;
  }

  .section-title::after {
    content: "";
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 40px;
    height: 3px;
    background: linear-gradient(45deg, #667eea, #764ba2);
    border-radius: 2px;
    box-shadow: 0 1px 3px rgba(102, 126, 234, 0.3);
  }

  /* Estados del sistema con indicadores modernos */
  .system-status {
    position: relative;
  }

  .status-indicator {
    position: relative;
    box-shadow: 0 0 20px rgba(34, 197, 94, 0.6);
    animation: pulse-ring 2s infinite;
  }

  .status-indicator::before {
    content: "";
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 50%;
    background: linear-gradient(
      45deg,
      rgba(34, 197, 94, 0.3),
      rgba(34, 197, 94, 0.1)
    );
    animation: rotate 3s linear infinite;
  }

  @keyframes pulse-ring {
    0% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
    }
    50% {
      transform: scale(1.1);
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 0 15px rgba(34, 197, 94, 0);
    }
  }

  @keyframes rotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  /* Lista de usuarios premium */
  .user-item {
    background: var(--bg-subtle);
    border: 1px solid var(--border-color);
    border-radius: 1rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .user-item::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(
      180deg,
      var(--accent-blue),
      var(--accent-purple)
    );
    transform: scaleY(0);
    transition: transform 0.3s ease;
  }

  .user-item:hover {
    background: var(--bg-hover);
    transform: translateX(8px);
    border-color: var(--accent-blue);
    box-shadow: var(--shadow-md);
  }

  .user-item:hover::before {
    transform: scaleY(1);
  }

  .user-avatar {
    background: linear-gradient(
      45deg,
      var(--accent-blue),
      var(--accent-purple)
    );
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .user-avatar::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255, 255, 255, 0.2), transparent);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .user-item:hover .user-avatar {
    transform: scale(1.15) rotate(5deg);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  }

  .user-item:hover .user-avatar::before {
    opacity: 1;
  }

  /* Efectos premium para botones de acción */
  .action-card {
    position: relative;
    overflow: hidden;
    border-radius: 1.5rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .action-card::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.1),
      transparent
    );
    transition: left 0.8s ease;
  }

  .action-card::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      45deg,
      rgba(59, 130, 246, 0.05) 0%,
      rgba(139, 92, 246, 0.05) 100%
    );
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .action-card:hover::before {
    left: 100%;
  }

  .action-card:hover::after {
    opacity: 1;
  }

  .action-card:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: var(--shadow-lg);
  }

  /* Gráfico mejorado con bordes brillantes */
  .chart-container {
    position: relative;
    background: var(--bg-card);
    border-radius: 1.5rem;
    overflow: hidden;
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
  }

  .chart-container::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(
      90deg,
      var(--accent-blue),
      var(--accent-purple),
      var(--accent-blue),
      var(--accent-green)
    );
    background-size: 300% 100%;
    animation: gradient-move 4s ease infinite;
  }

  .chart-container:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }

  @keyframes gradient-move {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  /* Responsive mejorado con breakpoints optimizados */
  @media (max-width: 1024px) {
    .admin-card:hover {
      transform: translateY(-4px) scale(1.01);
    }

    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }
  }

  @media (max-width: 768px) {
    .admin-card {
      margin-bottom: 1.5rem;
      border-radius: 1rem;
    }

    .admin-card:hover {
      transform: translateY(-2px);
    }

    .stats-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .actions-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .section-title {
      font-size: 1.5rem;
    }
  }

  @media (max-width: 480px) {
    .admin-card {
      padding: 1rem;
      border-radius: 0.75rem;
    }

    .stat-number {
      font-size: 1.5rem;
    }

    .icon-container {
      width: 2.5rem;
      height: 2.5rem;
    }
  }

  /* Estilos específicos mejorados para modo oscuro */
  [data-theme="dark"] .admin-card {
    background: linear-gradient(145deg, var(--bg-card), var(--bg-subtle));
    border-color: var(--border-color);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
  }

  [data-theme="dark"] .admin-card:hover {
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
    background: linear-gradient(145deg, var(--bg-subtle), var(--bg-hover));
  }

  [data-theme="dark"] .user-item {
    background: var(--bg-subtle);
    border-color: var(--border-color);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  [data-theme="dark"] .user-item:hover {
    background: var(--bg-hover);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
  }

  [data-theme="dark"] .text-gray-800,
  [data-theme="dark"] .text-gray-700,
  [data-theme="dark"] h1,
  [data-theme="dark"] h2,
  [data-theme="dark"] h3 {
    color: var(--text-primary) !important;
  }

  [data-theme="dark"] .text-gray-600,
  [data-theme="dark"] .text-gray-500 {
    color: var(--text-secondary) !important;
  }

  [data-theme="dark"] .chart-container {
    border-color: var(--border-color);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  }

  /* Dark mode icon backgrounds */
  [data-theme="dark"] .bg-blue-50 {
    background-color: rgba(59, 130, 246, 0.15) !important;
  }

  [data-theme="dark"] .bg-green-50 {
    background-color: rgba(34, 197, 94, 0.15) !important;
  }

  [data-theme="dark"] .bg-amber-50 {
    background-color: rgba(245, 158, 11, 0.15) !important;
  }

  [data-theme="dark"] .bg-purple-50 {
    background-color: rgba(139, 92, 246, 0.15) !important;
  }

  [data-theme="dark"] .border-blue-100,
  [data-theme="dark"] .border-green-100,
  [data-theme="dark"] .border-amber-100,
  [data-theme="dark"] .border-purple-100 {
    border-color: var(--border-color) !important;
  }

  /* Estilos específicos para modo claro */
  [data-theme="light"] .admin-card {
    background: linear-gradient(
      145deg,
      var(--bg-card),
      rgba(255, 255, 255, 0.8)
    );
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  [data-theme="light"] .admin-card:hover {
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
  }

  [data-theme="light"] .user-item {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
  }

  /* Animaciones de entrada escalonadas */
  .animate-slide-up {
    animation: slideUp 0.8s ease-out forwards;
  }

  .animate-slide-up-delay-1 {
    animation: slideUp 0.8s ease-out 0.1s forwards;
    opacity: 0;
  }

  .animate-slide-up-delay-2 {
    animation: slideUp 0.8s ease-out 0.2s forwards;
    opacity: 0;
  }

  .animate-slide-up-delay-3 {
    animation: slideUp 0.8s ease-out 0.3s forwards;
    opacity: 0;
  }

  .animate-fade-in {
    animation: fadeIn 0.6s ease-in forwards;
  }

  .animate-bounce-gentle {
    animation: bounceGentle 3s infinite;
  }

  /* Efectos de partículas para el header */
  .admin-gradient::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: radial-gradient(
        2px 2px at 20px 30px,
        rgba(255, 255, 255, 0.3),
        transparent
      ),
      radial-gradient(
        2px 2px at 40px 70px,
        rgba(255, 255, 255, 0.2),
        transparent
      ),
      radial-gradient(
        1px 1px at 90px 40px,
        rgba(255, 255, 255, 0.3),
        transparent
      ),
      radial-gradient(
        1px 1px at 130px 80px,
        rgba(255, 255, 255, 0.2),
        transparent
      );
    background-repeat: repeat;
    background-size: 150px 100px;
    animation: sparkle 4s linear infinite;
    pointer-events: none;
  }

  @keyframes sparkle {
    0% {
      transform: translateY(0);
      opacity: 1;
    }
    100% {
      transform: translateY(-100px);
      opacity: 0;
    }
  }

  /* Loading skeleton effect mejorado */
  .skeleton {
    background: linear-gradient(
      90deg,
      var(--bg-subtle) 25%,
      var(--bg-hover) 50%,
      var(--bg-subtle) 75%
    );
    background-size: 200% 100%;
    animation: loading 2s infinite;
    border-radius: 0.5rem;
  }

  @keyframes loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  /* Efectos de interacción mejorados */
  .interactive-element {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .interactive-element:active {
    transform: scale(0.98);
  }

  /* Microinteracciones para iconos */
  .admin-card .icon-container svg {
    transition: all 0.3s ease;
  }

  .admin-card:hover .icon-container svg {
    transform: scale(1.1);
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
  }


  /* Mejor alineación y espaciado consistente */
  .content-section {
    margin-bottom: 2rem;
  }

  .content-section:last-child {
    margin-bottom: 0;
  }

  /* Asegurar que todos los elementos mantengan la alineación */
  .dashboard-container {
    max-width: 100%;
    margin: 0 auto;
    padding-left: 1.5rem; /* px-6 equivalent */
    padding-right: 1.5rem;
  }

  /* Mejorar la consistencia del grid */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  @media (min-width: 768px) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .stats-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }
</style>
{% endblock %} {% block content %}

  <!-- Main Content Container  -->
  <div class="dashboard-container py-8 bg-[color:var(--background)]">
  <!-- Header Section Premium con alineación perfecta -->
  <div class="admin-gradient text-white mb-8 relative z-20">
    <div class="dashboard-container py-12 relative z-10">
      <div class="flex items-center justify-between animate-fade-in">
        <div class="flex items-center gap-6">
          <div
            class="w-20 h-20 bg-white/20 backdrop-blur-md rounded-3xl flex items-center justify-center border border-white/30 animate-bounce-gentle">
            <svg
              class="w-10 h-10 text-white drop-shadow-lg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
          </div>
          <div class="animate-slide-up">
            <h1 class="text-4xl font-black mb-2 text-white drop-shadow-lg">
              Panel de Administración
            </h1>
            <p class="text-white/90 text-lg font-medium">
              {% if current_user.is_authenticated and
              current_user.nombre_completo %} Bienvenido, {{
              current_user.nombre_completo }} {% else %} Bienvenido,
              Administrador {% endif %}
            </p>
            <div class="mt-2 flex items-center gap-2">
              <div
                class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
              <span class="text-white/80 text-sm">Sistema operativo</span>
            </div>
          </div>
        </div>

        <div class="text-right animate-slide-up-delay-1">
          <div
            class="bg-white/20 backdrop-blur-md rounded-2xl p-4 border border-white/30">
            <p class="text-white/80 text-sm font-medium mb-1">
              Última actualización
            </p>
            <p class="text-white font-bold text-lg">{{ current_time }}</p>
            <div class="mt-2 flex items-center justify-end gap-2">
              <div
                class="w-1.5 h-1.5 bg-blue-300 rounded-full animate-pulse"></div>
              <span class="text-white/70 text-xs">En tiempo real</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    <!-- Stats Cards Elegantes -->
    <div class="content-section">
      <div class="stats-grid">
        <!-- Total Users -->
        <div class="admin-card p-6 animate-slide-up interactive-element">
          <div class="flex items-center justify-between mb-4">
            <div
              class="icon-container w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center border border-blue-100">
              <svg
                class="w-6 h-6 text-blue-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
              </svg>
            </div>
            <span class="stat-number text-2xl font-bold"
              >{{ stats.total_usuarios or 0 }}</span
            >
          </div>
          <h3 class="font-semibold text-[color:var(--text-primary)] mb-1">
            Total Usuarios
          </h3>
          <p class="text-sm text-[color:var(--text-secondary)]">
            Registrados en el sistema
          </p>
        </div>

        <!-- Active Users -->
        <div
          class="admin-card p-6 animate-slide-up-delay-1 interactive-element">
          <div class="flex items-center justify-between mb-4">
            <div
              class="icon-container w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center border border-green-100">
              <svg
                class="w-6 h-6 text-green-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <span class="stat-number text-2xl font-bold"
              >{{ stats.usuarios_activos or 0 }}</span
            >
          </div>
          <h3 class="font-semibold text-[color:var(--text-primary)] mb-1">
            Usuarios Activos
          </h3>
          <p class="text-sm text-[color:var(--text-secondary)]">
            Con acceso habilitado
          </p>
        </div>

        <!-- Pending Users -->
        <div
          class="admin-card p-6 animate-slide-up-delay-2 interactive-element">
          <div class="flex items-center justify-between mb-4">
            <div
              class="icon-container w-12 h-12 bg-amber-50 rounded-xl flex items-center justify-center border border-amber-100">
              <svg
                class="w-6 h-6 text-amber-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <span class="stat-number text-2xl font-bold"
              >{{ stats.usuarios_inactivos or 0 }}</span
            >
          </div>
          <h3 class="font-semibold text-[color:var(--text-primary)] mb-1">
            Usuarios Inactivos
          </h3>
          <p class="text-sm text-[color:var(--text-secondary)]">
            Requieren atención
          </p>
        </div>

        <!-- System Health -->
        <div
          class="admin-card p-6 animate-slide-up-delay-3 interactive-element">
          <div class="flex items-center justify-between mb-4">
            <div
              class="icon-container w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center border border-green-100">
              <div
                class="status-indicator w-3 h-3 bg-green-500 rounded-full"></div>
            </div>
            <span class="stat-number text-2xl font-bold text-green-600"
              >OK</span
            >
          </div>
          <h3 class="font-semibold text-[color:var(--text-primary)] mb-1">
            Estado del Sistema
          </h3>
          <p class="text-sm text-[color:var(--text-secondary)]">
            Operando normalmente
          </p>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="content-section animate-slide-up-delay-1">
        <div class="flex items-center gap-4 mb-6">
          <h2
            class="section-title text-2xl font-bold text-[color:var(--text-primary)]">
            Acciones Rápidas
          </h2>
          <div class="flex-1 h-px bg-[color:var(--border-color)]"></div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Manage Users -->
          <a
            href="{{ url_for('admin.usuarios') }}"
            class="action-card admin-card p-6 hover:shadow-lg transition-all duration-300 group interactive-element">
            <div class="flex items-center justify-between mb-4">
              <div
                class="icon-container w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center group-hover:bg-blue-100 transition-colors border border-blue-100">
                <svg
                  class="w-6 h-6 text-blue-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
                </svg>
              </div>
              <svg
                class="w-5 h-5 text-[color:var(--text-secondary)] group-hover:text-blue-600 group-hover:translate-x-1 transition-all"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7" />
              </svg>
            </div>
            <h3
              class="font-semibold text-[color:var(--text-primary)] mb-2 group-hover:text-blue-600 transition-colors">
              Gestionar Usuarios
            </h3>
            <p
              class="text-sm text-[color:var(--text-secondary)] leading-relaxed">
              Administrar cuentas de usuario, roles y permisos del sistema
            </p>
          </a>

          <!-- Create User -->
          <a
            href="{{ url_for('admin.usuarios') }}"
            class="action-card admin-card p-6 hover:shadow-lg transition-all duration-300 group interactive-element">
            <div class="flex items-center justify-between mb-4">
              <div
                class="icon-container w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center group-hover:bg-green-100 transition-colors border border-green-100">
                <svg
                  class="w-6 h-6 text-green-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                </svg>
              </div>
              <svg
                class="w-5 h-5 text-[color:var(--text-secondary)] group-hover:text-green-600 group-hover:translate-x-1 transition-all"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7" />
              </svg>
            </div>
            <h3
              class="font-semibold text-[color:var(--text-primary)] mb-2 group-hover:text-green-600 transition-colors">
              Crear Usuario
            </h3>
            <p
              class="text-sm text-[color:var(--text-secondary)] leading-relaxed">
              Crear nuevas cuentas de usuario y asignar roles del sistema
            </p>
          </a>

          <!-- System Dashboard -->
          <a
            href="{{ url_for('main.index') }}"
            class="action-card admin-card p-6 hover:shadow-lg transition-all duration-300 group interactive-element">
            <div class="flex items-center justify-between mb-4">
              <div
                class="icon-container w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center group-hover:bg-purple-100 transition-colors border border-purple-100">
                <svg
                  class="w-6 h-6 text-purple-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
              </div>
              <svg
                class="w-5 h-5 text-[color:var(--text-secondary)] group-hover:text-purple-600 group-hover:translate-x-1 transition-all"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7" />
              </svg>
            </div>
            <h3
              class="font-semibold text-[color:var(--text-primary)] mb-2 group-hover:text-purple-600 transition-colors">
              Dashboard Principal
            </h3>
            <p
              class="text-sm text-[color:var(--text-secondary)] leading-relaxed">
              Acceder al dashboard principal del sistema y módulos
            </p>
          </a>
        </div>
      </div>
        
      <!-- Analytics & Recent Activity Section -->
        <div class="content-section animate-slide-up-delay-2">
          <div class="flex items-center gap-4 mb-6">
            <h2 class="section-title text-2xl font-bold text-[color:var(--text-primary)]">
              Actividad y Análisis
            </h2>
            <div class="flex-1 h-px bg-[color:var(--border-color)]"></div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Recent Users -->
            {% if recent_users %}
            <div class="admin-card p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold text-[color:var(--text-primary)]">
                  Usuarios Recientes
                </h3>
                <span
                  class="text-xs text-[color:var(--text-secondary)] bg-[color:var(--bg-subtle)] px-3 py-1.5 rounded-full">
                  {{ recent_users|length }} nuevos
                </span>
              </div>
              <div class="space-y-3">
                {% for user_item in recent_users %}
                <div
                  class="user-item p-3 rounded-lg flex items-center justify-between">
                  <div class="flex items-center gap-3">
                    <div
                      class="user-avatar w-10 h-10 rounded-xl flex items-center justify-center text-white font-semibold text-sm">
                      {{ user_item.nombre_completo[0] if
                      user_item.nombre_completo else 'U' }}
                    </div>
                    <div>
                      <p
                        class="font-semibold text-[color:var(--text-primary)] text-sm">
                        {{ user_item.nombre_completo or 'Sin nombre' }}
                      </p>
                      <p class="text-xs text-[color:var(--text-secondary)]">
                        {{ user_item.rol | title }} • {{ user_item.username }}
                      </p>
                    </div>
                  </div>
                  <div class="text-right">
                    <p class="text-xs text-[color:var(--text-secondary)] mb-1">
                      {{ user_item.fecha_creacion.strftime('%d/%m/%Y') if
                      user_item.fecha_creacion else 'Sin fecha' }}
                    </p>
                    <span class="inline-flex items-center gap-1">
                      <span
                        class="w-2 h-2 rounded-full {{ 'bg-green-500' if user_item.activo else 'bg-red-500' }}"></span>
                      <span class="text-xs text-[color:var(--text-tertiary)]">
                        {{ 'Activo' if user_item.activo else 'Inactivo' }}
                      </span>
                    </span>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
            {% endif %}

            <!-- Users by Role Chart -->
            <div class="admin-card p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold text-[color:var(--text-primary)]">
                  Distribución por Rol
                </h3>
                <span
                  class="text-xs text-[color:var(--text-secondary)] bg-[color:var(--bg-subtle)] px-3 py-1.5 rounded-full">
                  Análisis
                </span>
              </div>
              <div class="h-64 mb-4">
                <canvas id="rolesChart"></canvas>
              </div>
              <!-- Custom Legend -->
              <div class="grid grid-cols-2 gap-2" id="chartLegend">
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                  <span class="text-xs text-[color:var(--text-secondary)]"
                    >Administradores</span
                  >
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                  <span class="text-xs text-[color:var(--text-secondary)]"
                    >Managers</span
                  >
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                  <span class="text-xs text-[color:var(--text-secondary)]"
                    >Controllers</span
                  >
                </div>
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 bg-amber-500 rounded-full"></div>
                  <span class="text-xs text-[color:var(--text-secondary)]"
                    >Project Managers</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
   <script>
          // Enhanced Chart with theme support
          document.addEventListener('DOMContentLoaded', function() {
              const ctx = document.getElementById('rolesChart').getContext('2d');

              // Get theme colors
              const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
              const textColor = isDarkMode ? '#f5f5f7' : '#1e293b';
              const subtleColor = isDarkMode ? '#8e8e93' : '#64748b';

              const rolesData = {{ users_by_role | tojson | safe }};
              const labels = Object.keys(rolesData || {});
              const data = Object.values(rolesData || {});

              // Enhanced gradient colors - más sutiles y harmonicas
              const backgroundColors = [
                  'rgba(102, 126, 234, 0.8)',  // Azul principal
                  'rgba(34, 197, 94, 0.8)',    // Verde
                  'rgba(118, 75, 162, 0.8)',   // Púrpura
                  'rgba(245, 158, 11, 0.8)',   // Ámbar
                  'rgba(236, 72, 153, 0.8)',   // Rosa
                  'rgba(99, 102, 241, 0.8)'    // Índigo
              ];

              const borderColors = [
                  'rgb(102, 126, 234)',
                  'rgb(34, 197, 94)',
                  'rgb(118, 75, 162)',
                  'rgb(245, 158, 11)',
                  'rgb(236, 72, 153)',
                  'rgb(99, 102, 241)'
              ];

              const chart = new Chart(ctx, {
                  type: 'doughnut',
                  data: {
                      labels: labels.map(role => role.charAt(0).toUpperCase() + role.slice(1)),
                      datasets: [{
                          data: data,
                          backgroundColor: backgroundColors,
                          borderColor: borderColors,
                          borderWidth: 3,
                          hoverOffset: 15,
                          hoverBorderWidth: 4
                      }]
                  },
                  options: {
                      responsive: true,
                      maintainAspectRatio: false,
                      cutout: '60%',
                      animation: {
                          animateRotate: true,
                          animateScale: true,
                          duration: 1500,
                          easing: 'easeOutCubic'
                      },
                      interaction: {
                          intersect: false,
                          mode: 'nearest'
                      },
                      plugins: {
                          legend: {
                              display: false  // We have custom legend below
                          },
                          tooltip: {
                              backgroundColor: isDarkMode ? 'rgba(28, 28, 30, 0.95)' : 'rgba(255, 255, 255, 0.95)',
                              titleColor: textColor,
                              bodyColor: textColor,
                              borderColor: isDarkMode ? '#3a3a3c' : '#d0d7de',
                              borderWidth: 1,
                              cornerRadius: 12,
                              padding: 12,
                              displayColors: true,
                              boxPadding: 6,
                              callbacks: {
                                  label: function(context) {
                                      const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                      const percentage = ((context.raw / total) * 100).toFixed(1);
                                      return `${context.label}: ${context.raw} (${percentage}%)`;
                                  }
                              }
                          }
                      }
                  }
              });

              // Store chart reference for theme updates
              window.dashboardChart = chart;

              // Listen for theme changes
              const observer = new MutationObserver(function(mutations) {
                  mutations.forEach(function(mutation) {
                      if (mutation.type === 'attributes' && mutation.attributeName === 'data-theme') {
                          updateChartTheme();
                      }
                  });
              });

              observer.observe(document.documentElement, {
                  attributes: true,
                  attributeFilter: ['data-theme']
              });

              function updateChartTheme() {
                  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
                  const newTextColor = isDark ? '#f5f5f7' : '#1e293b';

                  chart.options.plugins.tooltip.backgroundColor = isDark ? 'rgba(28, 28, 30, 0.95)' : 'rgba(255, 255, 255, 0.95)';
                  chart.options.plugins.tooltip.titleColor = newTextColor;
                  chart.options.plugins.tooltip.bodyColor = newTextColor;
                  chart.options.plugins.tooltip.borderColor = isDark ? '#3a3a3c' : '#d0d7de';

                  chart.update('none');
              }

              // Animate cards on scroll with staggered effect
              const observerOptions = {
                  threshold: 0.1,
                  rootMargin: '0px 0px -50px 0px'
              };

              const cardObserver = new IntersectionObserver((entries) => {
                  entries.forEach((entry, index) => {
                      if (entry.isIntersecting) {
                          setTimeout(() => {
                              entry.target.style.opacity = '1';
                              entry.target.style.transform = 'translateY(0)';
                          }, index * 100);
                      }
                  });
              }, observerOptions);

              // Observe all cards with animation classes
              document.querySelectorAll('.admin-card').forEach((card, index) => {
                  if (card.classList.contains('animate-slide-up-delay-1') ||
                      card.classList.contains('animate-slide-up-delay-2') ||
                      card.classList.contains('animate-slide-up-delay-3')) {
                      card.style.opacity = '0';
                      card.style.transform = 'translateY(30px)';
                      card.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                      cardObserver.observe(card);
                  }
              });

              // Add number counting animation
              function animateNumber(element, start, end, duration) {
                  const range = end - start;
                  const increment = range / (duration / 16);
                  let current = start;

                  const timer = setInterval(() => {
                      current += increment;
                      if (current >= end) {
                          current = end;
                          clearInterval(timer);
                      }
                      element.textContent = Math.floor(current);
                  }, 16);
              }

              // Animate stat numbers when they come into view
              const statNumbers = document.querySelectorAll('.stat-number');
              statNumbers.forEach(statEl => {
                  const observer = new IntersectionObserver((entries) => {
                      entries.forEach(entry => {
                          if (entry.isIntersecting) {
                              const finalValue = parseInt(entry.target.textContent);
                              animateNumber(entry.target, 0, finalValue, 1500);
                              observer.unobserve(entry.target);
                          }
                      });
                  });
                  observer.observe(statEl);
              });
          });
        </script>
{% endblock %}
